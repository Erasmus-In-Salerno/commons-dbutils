
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta charset="UTF-8"/>
      <title>SpotBugs Report</title>
      <style type="text/css">
		.tablerow0 {
			background: #EEEEEE;
		}

		.tablerow1 {
			background: white;
		}

		.detailrow0 {
			background: #EEEEEE;
		}

		.detailrow1 {
			background: white;
		}

		.tableheader {
			background: #b9b9fe;
			font-size: larger;
		}

		.tablerow0:hover, .tablerow1:hover {
			background: #aaffaa;
		}

		.priority-1 {
				color: red;
				font-weight: bold;
		}
		.priority-2 {
				color: orange;
				font-weight: bold;
		}
		.priority-3 {
				color: green;
				font-weight: bold;
		}
		.priority-4 {
				color: blue;
				font-weight: bold;
		}
		</style>
      <script type="text/javascript">
			function toggleRow(elid) {
				if (document.getElementById) {
					element = document.getElementById(elid);
					if (element) {
						if (element.style.display == 'none') {
							element.style.display = 'block';
							//window.status = 'Toggle on!';
						} else {
							element.style.display = 'none';
							//window.status = 'Toggle off!';
						}
					}
				}
			}
		</script>
   </head>
   <body>
      <h1>
         <a href="https://spotbugs.github.io/">SpotBugs</a> Report</h1>
      <h2>Project Information</h2>
      <p>Project: 
		</p>
      <p>SpotBugs version: 4.5.3</p>
      <p>Code analyzed:</p>
      <ul>
         <li>target\classes\org\apache\commons\dbutils</li>
      </ul>
      <p>
         <br/>
         <br/>
      </p>
      <h2>Metrics</h2>
      <p>2192 lines of code analyzed,
	in 51 classes, 
	in 5 packages.</p>
      <table width="500" cellpadding="5" cellspacing="2">
         <tr class="tableheader">
            <th align="left">Metric</th>
            <th align="right">Total</th>
            <th align="right">Density*</th>
         </tr>
         <tr class="tablerow0">
            <td>High Priority Warnings</td>
            <td align="right"/>
            <td align="right">0.00</td>
         </tr>
         <tr class="tablerow1">
            <td>Medium Priority Warnings</td>
            <td align="right">8</td>
            <td align="right">3.65</td>
         </tr>
         <tr class="$totalClass">
            <td>
               <b>Total Warnings</b>
            </td>
            <td align="right">
               <b>8</b>
            </td>
            <td align="right">
               <b>3.65</b>
            </td>
         </tr>
      </table>
      <p>
         <i>(* Defects per Thousand lines of non-commenting source statements)</i>
      </p>
      <p>
         <br/>
         <br/>
      </p>
      <h2>Contents</h2>
      <ul>
         <li>
            <a href="#Warnings_SECURITY">Security Warnings</a>
         </li>
         <li>
            <a href="#Details">Details</a>
         </li>
      </ul>
      <h1>Summary</h1>
      <table width="500" cellpadding="5" cellspacing="2">
         <tr class="tableheader">
            <th align="left">Warning Type</th>
            <th align="right">Number</th>
         </tr>
         <tr class="tablerow0">
            <td>
               <a href="#Warnings_SECURITY">Security Warnings</a>
            </td>
            <td align="right">8</td>
         </tr>
         <tr class="tablerow1">
            <td>
               <b>Total</b>
            </td>
            <td align="right">
               <b>8</b>
            </td>
         </tr>
      </table>
      <h1>Warnings</h1>
      <p>Click on a warning row to see full context information.</p>
      <h2>
         <a name="Warnings_SECURITY">Security Warnings</a>
      </h2>
      <table class="warningtable" width="100%" cellspacing="0">
         <tr class="tableheader">
            <th align="left">Code</th>
            <th align="left">Warning</th>
         </tr>
         <tr class="tablerow1" onclick="toggleRow('d1e142');">
            <td>
               <span class="priority-2">ERRMSG</span>
            </td>
            <td>Possible information exposure through an error message</td>
         </tr>
         <tr class="detailrow1">
            <td/>
            <td>
               <p id="d1e142" style="display: none;">
                  <a href="#INFORMATION_EXPOSURE_THROUGH_AN_ERROR_MESSAGE">Bug type INFORMATION_EXPOSURE_THROUGH_AN_ERROR_MESSAGE (click for details)</a>
                  <br/>In class org.apache.commons.dbutils.DbUtils<br/>In method org.apache.commons.dbutils.DbUtils.printStackTrace(SQLException, PrintWriter)<br/>At DbUtils.java:[line 324]</p>
            </td>
         </tr>
         <tr class="tablerow0" onclick="toggleRow('d1e5');">
            <td>
               <span class="priority-2">SECSQLIJDBC</span>
            </td>
            <td>This use of java/sql/Connection.prepareCall(Ljava/lang/String;)Ljava/sql/CallableStatement; can be vulnerable to SQL injection (with JDBC)</td>
         </tr>
         <tr class="detailrow0">
            <td/>
            <td>
               <p id="d1e5" style="display: none;">
                  <a href="#SQL_INJECTION_JDBC">Bug type SQL_INJECTION_JDBC (click for details)</a>
                  <br/>In class org.apache.commons.dbutils.AbstractQueryRunner<br/>In method org.apache.commons.dbutils.AbstractQueryRunner.prepareCall(Connection, String)<br/>At AbstractQueryRunner.java:[line 503]<br/>Sink method java/sql/Connection.prepareCall(Ljava/lang/String;)Ljava/sql/CallableStatement;<br/>Sink parameter 0<br/>Unknown source org/apache/commons/dbutils/AbstractQueryRunner.prepareCall(Ljava/sql/Connection;Ljava/lang/String;)Ljava/sql/CallableStatement; parameter 0<br/>Method usage not detected<br/>At QueryRunner.java:[line 220]<br/>At QueryRunner.java:[line 275]<br/>At QueryRunner.java:[line 324]<br/>At QueryRunner.java:[line 351]</p>
            </td>
         </tr>
         <tr class="tablerow1" onclick="toggleRow('d1e34');">
            <td>
               <span class="priority-2">SECSQLIJDBC</span>
            </td>
            <td>This use of java/sql/Connection.prepareStatement(Ljava/lang/String;)Ljava/sql/PreparedStatement; can be vulnerable to SQL injection (with JDBC)</td>
         </tr>
         <tr class="detailrow1">
            <td/>
            <td>
               <p id="d1e34" style="display: none;">
                  <a href="#SQL_INJECTION_JDBC">Bug type SQL_INJECTION_JDBC (click for details)</a>
                  <br/>In class org.apache.commons.dbutils.AbstractQueryRunner<br/>In method org.apache.commons.dbutils.AbstractQueryRunner.prepareStatement(Connection, String)<br/>At AbstractQueryRunner.java:[line 549]<br/>Sink method java/sql/Connection.prepareStatement(Ljava/lang/String;)Ljava/sql/PreparedStatement;<br/>Sink parameter 0<br/>Unknown source org/apache/commons/dbutils/AbstractQueryRunner.prepareStatement(Ljava/sql/Connection;Ljava/lang/String;)Ljava/sql/PreparedStatement; parameter 0<br/>Method usage not detected<br/>At AsyncQueryRunner.java:[line 303]<br/>At AsyncQueryRunner.java:[line 319]<br/>At AsyncQueryRunner.java:[line 432]<br/>At AsyncQueryRunner.java:[line 448]<br/>At AsyncQueryRunner.java:[line 464]<br/>At AsyncQueryRunner.java:[line 481]<br/>At AsyncQueryRunner.java:[line 494]<br/>At AsyncQueryRunner.java:[line 508]<br/>At AsyncQueryRunner.java:[line 521]<br/>At AsyncQueryRunner.java:[line 536]<br/>At AsyncQueryRunner.java:[line 552]<br/>At AsyncQueryRunner.java:[line 568]<br/>At QueryRunner.java:[line 149]<br/>At QueryRunner.java:[line 184]<br/>At QueryRunner.java:[line 539]<br/>At QueryRunner.java:[line 556]<br/>At QueryRunner.java:[line 570]<br/>At QueryRunner.java:[line 603]<br/>At QueryRunner.java:[line 641]<br/>At QueryRunner.java:[line 664]<br/>At QueryRunner.java:[line 682]<br/>At QueryRunner.java:[line 701]<br/>At QueryRunner.java:[line 734]<br/>At QueryRunner.java:[line 748]<br/>At QueryRunner.java:[line 774]<br/>At QueryRunner.java:[line 806]<br/>At QueryRunner.java:[line 824]<br/>At QueryRunner.java:[line 842]</p>
            </td>
         </tr>
         <tr class="tablerow0" onclick="toggleRow('d1e113');">
            <td>
               <span class="priority-2">SECSQLIJDBC</span>
            </td>
            <td>This use of java/sql/Connection.prepareStatement(Ljava/lang/String;I)Ljava/sql/PreparedStatement; can be vulnerable to SQL injection (with JDBC)</td>
         </tr>
         <tr class="detailrow0">
            <td/>
            <td>
               <p id="d1e113" style="display: none;">
                  <a href="#SQL_INJECTION_JDBC">Bug type SQL_INJECTION_JDBC (click for details)</a>
                  <br/>In class org.apache.commons.dbutils.AbstractQueryRunner<br/>In method org.apache.commons.dbutils.AbstractQueryRunner.prepareStatement(Connection, String, int)<br/>At AbstractQueryRunner.java:[line 587]<br/>Sink method java/sql/Connection.prepareStatement(Ljava/lang/String;I)Ljava/sql/PreparedStatement;<br/>Sink parameter 1<br/>Unknown source org/apache/commons/dbutils/AbstractQueryRunner.prepareStatement(Ljava/sql/Connection;Ljava/lang/String;I)Ljava/sql/PreparedStatement; parameter 1<br/>Method usage not detected<br/>At AsyncQueryRunner.java:[line 401]<br/>At AsyncQueryRunner.java:[line 418]<br/>At QueryRunner.java:[line 486]<br/>At QueryRunner.java:[line 521]</p>
            </td>
         </tr>
         <tr class="tablerow1" onclick="toggleRow('d1e154');">
            <td>
               <span class="priority-2">SECSQLIJDBC</span>
            </td>
            <td>This use of java/sql/Connection.prepareStatement(Ljava/lang/String;I)Ljava/sql/PreparedStatement; can be vulnerable to SQL injection (with JDBC)</td>
         </tr>
         <tr class="detailrow1">
            <td/>
            <td>
               <p id="d1e154" style="display: none;">
                  <a href="#SQL_INJECTION_JDBC">Bug type SQL_INJECTION_JDBC (click for details)</a>
                  <br/>In class org.apache.commons.dbutils.QueryRunner<br/>In method org.apache.commons.dbutils.QueryRunner.insert(Connection, String, ResultSetHandler, Object[])<br/>At QueryRunner.java:[line 400]<br/>Sink method java/sql/Connection.prepareStatement(Ljava/lang/String;I)Ljava/sql/PreparedStatement;<br/>Sink parameter 1<br/>Unknown source org/apache/commons/dbutils/QueryRunner.insert(Ljava/sql/Connection;Ljava/lang/String;Lorg/apache/commons/dbutils/ResultSetHandler;[Ljava/lang/Object;)Ljava/lang/Object; parameter 2<br/>Method usage not detected<br/>At AsyncQueryRunner.java:[line 335]<br/>At AsyncQueryRunner.java:[line 352]<br/>At AsyncQueryRunner.java:[line 367]<br/>At AsyncQueryRunner.java:[line 383]<br/>At QueryRunner.java:[line 367]<br/>At QueryRunner.java:[line 434]<br/>At QueryRunner.java:[line 454]</p>
            </td>
         </tr>
         <tr class="tablerow0" onclick="toggleRow('d1e189');">
            <td>
               <span class="priority-2">SECSQLIJDBC</span>
            </td>
            <td>This use of java/sql/Statement.executeUpdate(Ljava/lang/String;I)I can be vulnerable to SQL injection (with JDBC)</td>
         </tr>
         <tr class="detailrow0">
            <td/>
            <td>
               <p id="d1e189" style="display: none;">
                  <a href="#SQL_INJECTION_JDBC">Bug type SQL_INJECTION_JDBC (click for details)</a>
                  <br/>In class org.apache.commons.dbutils.QueryRunner<br/>In method org.apache.commons.dbutils.QueryRunner.insert(Connection, String, ResultSetHandler, Object[])<br/>At QueryRunner.java:[line 406]<br/>Sink method java/sql/Statement.executeUpdate(Ljava/lang/String;I)I<br/>Sink parameter 1<br/>Unknown source org/apache/commons/dbutils/QueryRunner.insert(Ljava/sql/Connection;Ljava/lang/String;Lorg/apache/commons/dbutils/ResultSetHandler;[Ljava/lang/Object;)Ljava/lang/Object; parameter 2<br/>Method usage not detected<br/>At AsyncQueryRunner.java:[line 335]<br/>At AsyncQueryRunner.java:[line 352]<br/>At AsyncQueryRunner.java:[line 367]<br/>At AsyncQueryRunner.java:[line 383]<br/>At QueryRunner.java:[line 367]<br/>At QueryRunner.java:[line 434]<br/>At QueryRunner.java:[line 454]</p>
            </td>
         </tr>
         <tr class="tablerow1" onclick="toggleRow('d1e224');">
            <td>
               <span class="priority-2">SECSQLIJDBC</span>
            </td>
            <td>This use of java/sql/Statement.executeQuery(Ljava/lang/String;)Ljava/sql/ResultSet; can be vulnerable to SQL injection (with JDBC)</td>
         </tr>
         <tr class="detailrow1">
            <td/>
            <td>
               <p id="d1e224" style="display: none;">
                  <a href="#SQL_INJECTION_JDBC">Bug type SQL_INJECTION_JDBC (click for details)</a>
                  <br/>In class org.apache.commons.dbutils.QueryRunner<br/>In method org.apache.commons.dbutils.QueryRunner.query(Connection, String, ResultSetHandler, Object[])<br/>At QueryRunner.java:[line 609]<br/>Sink method java/sql/Statement.executeQuery(Ljava/lang/String;)Ljava/sql/ResultSet;<br/>Sink parameter 0<br/>Unknown source org/apache/commons/dbutils/QueryRunner.query(Ljava/sql/Connection;Ljava/lang/String;Lorg/apache/commons/dbutils/ResultSetHandler;[Ljava/lang/Object;)Ljava/lang/Object; parameter 2<br/>Method usage not detected<br/>At AsyncQueryRunner.java:[line 432]<br/>At AsyncQueryRunner.java:[line 448]<br/>At AsyncQueryRunner.java:[line 464]<br/>At AsyncQueryRunner.java:[line 481]<br/>At QueryRunner.java:[line 539]<br/>At QueryRunner.java:[line 556]<br/>At QueryRunner.java:[line 570]<br/>At QueryRunner.java:[line 641]<br/>At QueryRunner.java:[line 664]<br/>At QueryRunner.java:[line 682]<br/>At QueryRunner.java:[line 701]</p>
            </td>
         </tr>
         <tr class="tablerow0" onclick="toggleRow('d1e267');">
            <td>
               <span class="priority-2">SECSQLIJDBC</span>
            </td>
            <td>This use of java/sql/Statement.executeUpdate(Ljava/lang/String;)I can be vulnerable to SQL injection (with JDBC)</td>
         </tr>
         <tr class="detailrow0">
            <td/>
            <td>
               <p id="d1e267" style="display: none;">
                  <a href="#SQL_INJECTION_JDBC">Bug type SQL_INJECTION_JDBC (click for details)</a>
                  <br/>In class org.apache.commons.dbutils.QueryRunner<br/>In method org.apache.commons.dbutils.QueryRunner.update(Connection, String, Object[])<br/>At QueryRunner.java:[line 780]<br/>Sink method java/sql/Statement.executeUpdate(Ljava/lang/String;)I<br/>Sink parameter 0<br/>Unknown source org/apache/commons/dbutils/QueryRunner.update(Ljava/sql/Connection;Ljava/lang/String;[Ljava/lang/Object;)I parameter 1<br/>Method usage not detected<br/>At AsyncQueryRunner.java:[line 494]<br/>At AsyncQueryRunner.java:[line 508]<br/>At AsyncQueryRunner.java:[line 521]<br/>At AsyncQueryRunner.java:[line 536]<br/>At AsyncQueryRunner.java:[line 552]<br/>At AsyncQueryRunner.java:[line 568]<br/>At QueryRunner.java:[line 734]<br/>At QueryRunner.java:[line 748]<br/>At QueryRunner.java:[line 806]<br/>At QueryRunner.java:[line 824]<br/>At QueryRunner.java:[line 842]</p>
            </td>
         </tr>
      </table>
      <h1>
         <a name="Details">Details</a>
      </h1>
      <h2>
         <a name="INFORMATION_EXPOSURE_THROUGH_AN_ERROR_MESSAGE">INFORMATION_EXPOSURE_THROUGH_AN_ERROR_MESSAGE: Information Exposure Through An Error Message</a>
      </h2>
            
<p>
The sensitive information may be valuable information on its own (such as a password), or it may be useful for launching other, more deadly attacks. If an attack fails, an attacker may use error information provided by the server to launch another more focused attack. For example, an attempt to exploit a path traversal weakness (CWE-22) might yield the full pathname of the installed application. In turn, this could be used to select the proper number of ".." sequences to navigate to the targeted file. An attack using SQL injection (CWE-89) might not initially succeed, but an error message could reveal the malformed query, which would expose query logic and possibly even passwords or other sensitive information used within the query.
</p>
<p>
    <b>Vulnerable Code:</b><br/>
<pre>try {
  out = httpResponse.getOutputStream()
} catch (Exception e) {
  e.printStackTrace(out);
}</pre>
</p>
<p>
<b>References</b><br/>
<a href="https://cwe.mitre.org/data/definitions/209.html">CWE-209: Information Exposure Through an Error Message</a><br/>
<a href="https://cwe.mitre.org/data/definitions/211.html">CWE-211: Information Exposure Through Externally-Generated Error Message</a><br/>
</p>
            
        <h2>
         <a name="SQL_INJECTION_JDBC">SQL_INJECTION_JDBC: Potential JDBC Injection</a>
      </h2>
            
<p>
The input values included in SQL queries need to be passed in safely.
Bind variables in prepared statements can be used to easily mitigate the risk of SQL injection.
</p>

<p>
    <b>Vulnerable Code:</b><br/>
    <pre>Connection conn = [...];
Statement stmt = con.createStatement();
ResultSet rs = stmt.executeQuery("update COFFEES set SALES = "+nbSales+" where COF_NAME = '"+coffeeName+"'");</pre>
</p>
<p>
    <b>Solution:</b><br/>
    <pre>Connection conn = [...];
conn.prepareStatement("update COFFEES set SALES = ? where COF_NAME = ?");
updateSales.setInt(1, nbSales);
updateSales.setString(2, coffeeName);</pre>
</p>
<br/>

<b>References (JDBC)</b><br/>
<a href="https://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html">Oracle Documentation: The Java Tutorials &gt; Prepared Statements</a><br/>
<b>References (SQL injection)</b><br/>
<a href="http://projects.webappsec.org/w/page/13246963/SQL%20Injection">WASC-19: SQL Injection</a><br/>
<a href="https://capec.mitre.org/data/definitions/66.html">CAPEC-66: SQL Injection</a><br/>
<a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">OWASP: Top 10 2013-A1-Injection</a><br/>
<a href="https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet">OWASP: SQL Injection Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet">OWASP: Query Parameterization Cheat Sheet</a><br/>
</p>

        </body>
</html>
